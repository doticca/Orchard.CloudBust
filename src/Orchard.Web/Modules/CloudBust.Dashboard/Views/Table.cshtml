@using CloudBust.Dashboard
@using Orchard.Users.Models
@using Orchard.Security
@using CloudBust.Application.Models

@model CloudBust.Dashboard.ViewModels.TableViewModel
@functions{
    dynamic appParameterValue(ParameterRecord entry){
        switch (entry.ParameterType.ToLower())
        {
            case "int":
                return entry.ParameterValueInt;
            case "double":
                return entry.ParameterValueDouble;
            case "bool":
                return entry.ParameterValueBool;
            case "datetime":
                return entry.ParameterValueDateTime;
            default:
                return entry.ParameterValueString;
        }                    
    }
    
}
@{
    
    string deleteurl = Url.Content("~") + "dashboard/applications/" + Model.DataTable.Id + "/delete";
    string reseturl = Url.Content("~") + "dashboard/applications/" + Model.DataTable.Id + "/reset";

    string codeurl = @"https://" + Model.Uri.Host.ToString();

    string[] a_page = { string.Empty, string.Empty };
    string[] b_page = { string.Empty, string.Empty };
    string[] a_url = { 
                         Url.Content("~") + "dashboard/datatables/" + Model.DataTable.Id, 
                         Url.Content("~") + "dashboard/datatables/" + Model.DataTable.Id + "/fields", 
                     };
    string create_url = Url.Content("~") + "dashboard/datatables/" + Model.DataTable.Id + "/fields/create";
    
    string[] a_title = {
                           "Table Information",
                           "Fields",                 
                       };
    string[] a_category = {
                           "Settings",
                           "Settings", 
                       };                                            

        
    a_page[Model.Page] = "active";
    b_page[Model.Page] = "current";

    IUser webUser = Model.User;
}


<div class="dashboardarea">
    <ul class="breadcrumbs hide-for-small">
        <li><a href="~/dashboard">Dashboard</a></li>
        <li><a href="~/dashboard/datatables">Tables</a></li>
        <li class="@b_page[0]"><a href="@a_url[0]">@Model.DataTable.Name</a></li>
        <li class="current"><a href="#">@a_category[Model.Page]</a></li>
        <li class="@b_page[Model.Page]"><a href="@a_url[Model.Page]">@a_title[Model.Page]</a></li>
    </ul>
    <div class="row">
        <div class="large-3 medium-4 columns">
            <div class="hide-for-small">
                <div class="sidebar">
                    <h1 class="header-app subhead">
                        @Model.DataTable.Name
                        <div><small>@Model.DataTable.Description</small></div>
                    </h1>

                    <nav>
                        <ul class="side-nav">
                            <li class="heading">Settings</li>
                            <li class="@a_page[0]"><a href="@a_url[0]">@a_title[0]</a></li>
                            <li class="@a_page[1]"><a href="@a_url[1]">@a_title[1]</a></li>
                            <li class="divider"></li>
                            @*<li class="heading">Senseapi ®</li>
                            <li class="@a_page[2]"><a href="@a_url[2]">@a_title[2]</a></li>*@
                        </ul>
                    </nav>


                </div>
            </div>
        </div>

        @if (Model.Page == 0)
        {
            <div class="large-9 medium-8 columns bump-25 end">
                <h1 class="subhead">
                    Information
                    <div><small>Basic settings to have a senseapi Game up and running</small></div>
                </h1>

                <hr />

                @using (Html.BeginFormAntiForgeryPost())
                {
                    <div class="row">
                        <div class="large-12 columns">
                            <label for="Name">
                                Name
                                @Html.TextBoxFor(m => m.DataTable.Name, new { })
                            </label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="large-12 columns">
                            <label for="Description">
                                Description
                                @Html.TextBoxFor(m => m.DataTable.Description, new { })
                            </label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="large-12 columns">
                            <button class="" type="submit" name="submit.Save" value="Save">Save</button>
                        </div>
                    </div>
                }

                <hr />

                <div class="row">
                    <div class="large-12 columns">
                        <div class="alert alert-message block-message">
                            <h5>Remove Table</h5>
                            <div class="row">
                                <div class="large-7 medium-8 small-9 columns">
                                    <span class="label warning">Warning</span> Removing this table will remove all associated fields and data <em class="red">completely</em>! There is no way to undo this, so proceed with caution.
                                </div>

                                <div class="large-5 medium-4 small-3 text-center columns">
                                    <a href="@deleteurl" class="primary btn delete wide pull-right small">Remove Table</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row bump-25"></div>

            </div>
        }
                       
        @if (Model.Page == 1)
        {
            <div class="large-9 medium-8 columns bump-25 end">
                <h1 class="subhead">
                    Table Fields
                    <div><small>Define your table's Fields.</small></div>
                </h1>
                <hr />
                <div class="row">
                    <div class="large-12 columns">
                        <h2 class="subhead">
                            Row Fields
                            <div>
                                <small>
                                    Define all the fields of your Table and you can access/edit them through CloudBust SDK.
                                </small>
                            </div>
                        </h2>
                    </div>
                </div>

                <div class="row">
                    <div class="large-12 columns">
                        <table>
                            <thead>
                                <tr>
                                    <th width="50">&nbsp;</th>
                                    @*<th width="50">Process</th>*@
                                    <th width="150">Name</th>
                                    <th width="300">Description</th>
                                    <th width="100">Type</th>
                                    <th width="180">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @*@foreach (GameEventRecord role in Model.Events)
                                {
                                    <tr>
                                        <td>
                                            @if (role.BusinessProcess > 1)
                                            {
                                                <a href="~/dashboard/games/@Model.Game.AppKey/events/@role.Id/moveup" class="fi-arrow-up"></a>
                                            }

                                            @if (role.BusinessProcess < Model.Events.Count())
                                            {
                                                <a href="~/dashboard/games/@Model.Game.AppKey/events/@role.Id/movedown" class="fi-arrow-down"></a>
                                            }
                                        </td>
                                        <td>
                                            @role.Name
                                        </td>
                                        <td>
                                            @role.Description
                                        </td>
                                        <td>
                                            @( ((GameEventType)role.GameEventType).ToEventString() )
                                        </td>
                                        <td>
                                            <a href="~/dashboard/games/@Model.Game.AppKey/events/@role.Id/edit" class="tiny button">Edit</a>
                                            <a href="~/dashboard/games/@Model.Game.AppKey/events/@role.Id/delete" class="tiny button alert">Delete</a>
                                        </td>
                                    </tr>
                                }*@
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="row">
                    <div class="large-12 columns">
                        <a class="button" href="@create_url"><i class="fi-plus"></i>  Add a Field</a>
                    </div>
                </div>
                <div class="row bump-25"></div>
            </div>
        }
    </div>
</div>

@using(Script.Foot()){
<script type="text/javascript">
    $(function () {                    
    });
</script>
}
